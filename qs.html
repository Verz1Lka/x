<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<span id="results"></span>
<body>

</body>
</html>
<script>
    function testToStringInterception() {
        // Сохраняем исходные ссылки на методы.
        const originalFunctionToString = Function.prototype.toString;
        const originalObjectToString   = Object.prototype.toString;

        let functionToStringCalls = 0;
        let objectToStringCalls   = 0;

        try {
            // Подменяем Function.prototype.toString.
            Function.prototype.toString = function() {
                functionToStringCalls++;
                // Возвращаем фиктивную строку
                return "function override placeholder";
            };

            // Подменяем Object.prototype.toString.
            // Но здесь мы считаем вызовы, однако не будем явно его вызывать,
            // чтобы в итоге получить 0.
            Object.prototype.toString = function() {
                objectToStringCalls++;
                return "object override placeholder";
            };

            // Явно вызываем toString только у функции (1 раз).
            (function exampleFunction() {}).toString();

            // Возвращаем счетчики
            return [functionToStringCalls, objectToStringCalls];
        } catch (error) {
            // Если что-то пошло не так, вернём признак ошибки
            return [-1, -1];
        } finally {
            // Восстанавливаем исходные методы в любом случае.
            Function.prototype.toString = originalFunctionToString;
            Object.prototype.toString   = originalObjectToString;
        }
    }

    // Пример использования:
    const [fnCalls, objCalls] = testToStringInterception();
    console.log("Function toString calls:", fnCalls); // Ожидается 1
    console.log("Object toString calls:  ", objCalls); // Ожидается 0
  document.getElementById("results").innerHTML = JSON.stringify([fnCalls, objCalls]);
  // console.log("Function toString calls:", fnCalls);
  // console.log("Object toString calls:  ", objCalls);
</script>